function RBNode(l,i){this.key=l,this.data=i,this.lChild=null,this.rChild=null,this.pNode=null,this.height=0,this.color=1,this.pre=null,this.next=null}function RBTree(){this.root=null}var _proto=RBTree.prototype;_proto.insert=function(l,i){var o=new RBNode(l,i);return this.root?this._insert(this.root,o):(o.color=0,this.root=o,!0)},_proto.delete=function(l){var i=this._delete(this.root,l);return i.pre&&(i.pre.next=i.next),i.next&&(i.next.pre=i.pre),i},_proto.search=function(l){return this._search(this.root,l)},_proto._insert=function(l,i){if(l.key==i.key)return!1;if(l.key>i.key)if(l.lChild){if(!this._insert(l.lChild,i))return!1;this._insertBalance(l)}else(l.lChild=i).pNode=l;else if(l.rChild){if(!this._insert(l.rChild,i))return!1;this._insertBalance(l)}else(l.rChild=i).pNode=l;return!i.next&&l.key>i.key?(i.next=l).pre=i:!i.pre&&l.key<i.key&&((i.pre=l).next=i),this._setHeight(l),!0},_proto._delete=function(l,i){if(!l)return!1;if(l.key!=i)return l.key>i?!!(h=this._delete(l.lChild,i))&&(this._setHeight(l),h):!!(h=this._delete(l.rChild,i))&&(this._setHeight(l),h);if(l.lChild||l.rChild){if(l.lChild&&l.rChild){for(var o=l.lChild.rChild,t=l.lChild;o&&o.rChild;)o=o.rChild;o||(o=t),this._change(l,o);var h=this._delete(l.lChild,i);return this._setHeight(o),h}var r=l.lChild||l.rChild;return this.root==l?(this.root=r,this.root.color=0,this.root.pNode=null):(0==l.color&&(r.color=0),l.pNode.lChild==l?l.pNode.lChild=r:l.pNode.rChild=r,r.pNode=l.pNode,this._setHeight(l.pNode)),l}return this.root==l?this.root=null:l.pNode.lChild==l?(l.pNode.lChild=null,this._setHeight(l.pNode),0==l.color&&this._deleteBalance(l.pNode,!0)):(l.pNode.rChild=null,this._setHeight(l.pNode),0==l.color&&this._deleteBalance(l.pNode,!1)),l},_proto._search=function(l,i){return!!l&&(l.key==i?l:l.key>i?this._search(l.lChild,i):this._search(l.rChild,i))},_proto._rRotate=function(l,i){var o=l.lChild;o.pNode=l.pNode,l.lChild=o.rChild,o.rChild&&(o.rChild.pNode=l),o.rChild=l,i&&(l.color=1,o.color=0),l==this.root?(this.root=o,this.root.color=0):l.pNode.lChild==l?l.pNode.lChild=o:l.pNode.rChild=o,l.pNode=o,this._setHeight(l),this._setHeight(o)},_proto._lRotate=function(l,i){var o=l.rChild;o.pNode=l.pNode,l.rChild=o.lChild,o.lChild&&(o.lChild.pNode=l),o.lChild=l,i&&(l.color=1,o.color=0),l==this.root?(this.root=o,this.root.color=0):l.pNode.lChild==l?l.pNode.lChild=o:l.pNode.rChild=o,l.pNode=o,this._setHeight(l),this._setHeight(o)},_proto._lrRotate=function(l){this._lRotate(l.lChild),this._rRotate(l,!0)},_proto._rlRotate=function(l){this._lRotate(l.rChild),this._lRotate(l,!0)},_proto._insertBalance=function(l){if(l.rChild&&1==l.rChild.color&&(l.rChild.lChild&&1==l.rChild.lChild.color||l.rChild.rChild&&1==l.rChild.rChild.color)){l.lChild&&1==l.lChild.color?(l.lChild.color=0,l.rChild.color=0,l!=this.root&&(l.color=1)):(l.rChild,l.rChild.rChild&&1==l.rChild.rChild.color?this._lRotate(l,!0):this._rlRotate(l))}else if(l.lChild&&1==l.lChild.color&&(l.lChild.lChild&&1==l.lChild.lChild.color||l.lChild.rChild&&1==l.lChild.rChild.color)){l.rChild&&1==l.rChild.color?(l.lChild.color=0,l.rChild.color=0,l!=this.root&&(l.color=1)):(l.lChild,l.lChild.lChild&&1==l.lChild.lChild.color?this._rRotate(l,!0):this._lrRotate(l))}else this._setHeight(l)},_proto._deleteBalance=function(l,i){if(l)if(i)if(l.rChild&&1==l.rChild.color)l.color=1,l.rChild.color=0,this._lRotate(l),this._deleteBalance(l,!0);else if(l.rChild&&(l.rChild.lChild&&1==l.rChild.lChild.color||l.rChild.rChild&&1==l.rChild.rChild.color)){l.rChild.rChild&&1==l.rChild.rChild.color||(l.rChild.lChild.color=0,l.rChild.color=1,this._rRotate(l.rChild));var o=l.color;l.color=l.rChild.color,l.rChild.color=o,l.rChild.rChild.color=0,this._lRotate(l)}else 1==l.color?(l.color=0,l.rChild.color=1):(l.rChild&&(l.rChild.color=1),l!=this.root&&(l.pNode.lChild==l?this._deleteBalance(l.pNode,!0):this._deleteBalance(l.pNode,!1)));else if(l.lChild&&1==l.lChild.color)l.color=1,l.lChild.color=0,this._rRotate(l),this._deleteBalance(l,!1);else if(l.lChild&&(l.lChild.lChild&&1==l.lChild.lChild.color||l.lChild.rChild&&1==l.lChild.rChild.color)){l.lChild.lChild&&1==l.lChild.lChild.color||(l.lChild.rChild.color=0,l.lChild.color=1,this._lRotate(l.lChild));o=l.color;l.color=l.lChild.color,l.lChild.color=o,l.lChild.lChild.color=0,this._rRotate(l)}else 1==l.color?(l.color=0,l.lChild.color=1):(l.lChild&&(l.lChild.color=1),l!=this.root&&(l.pNode.lChild==l?this._deleteBalance(l.pNode,!0):this._deleteBalance(l.pNode,!1)))},_proto._change=function(l,i){var o=l.key,t=l.data;l.key=i.key,l.data=i.data,i.key=o,i.data=t},_proto._getHeight=function(l){return l?l.height:0},_proto._setHeight=function(l){var i=Math.max(this._getHeight(l.lChild),this._getHeight(l.rChild))+1;l.lChild||l.rChild||(i=0),l.height=i};